# @package _global_

defaults:
  - launcher: local
  - model: default
  - training: default
  - paths: juelich
  - datamodule: lung_healthy
  - _self_
  - override paths/anatomy: lung_healthy

############ Job specific configurations ############

name: hescape_default_training

model:
  litmodule:
    img_enc_name: h0-mini
    img_finetune: true
    img_proj: mlp
    gene_enc_name: generic
    gene_finetune: false
    gene_proj: linear # mlp
    loss: CLIP
    temperature: 0.07

datamodule:
  seed: 24442
  batch_size: 64
  num_workers: 4
  pin_memory: true
  persistent_workers: true

training:
  lightning:
    trainer:
      max_steps: 20_000
      devices: ${devices_per_job}
      num_nodes: 1
      strategy: # "ddp"
        _target_: pytorch_lightning.strategies.DDPStrategy
        find_unused_parameters: true
        process_group_backend: "nccl"
      accelerator: "gpu"
  train: true
  test:
    false
    # profiler: simple

  logger:
    wandb:
      project: hescape_training
