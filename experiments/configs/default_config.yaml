# @package _global_

defaults:
  - launcher: juelich
  - model: default
  - training: default
  - paths: juelich
  - datamodule: breast
  - _self_
  - override paths/anatomy: breast

############ Job specific configurations ############

name: hescape_default_training

training:
  lightning:
    trainer:
      max_steps: 20_000
      devices: ${hydra:launcher.tasks_per_node}
      num_nodes: 1
      strategy: # "ddp"
        _target_: pytorch_lightning.strategies.DDPStrategy
      accelerator: "gpu"
  train: true
  test: false

  logger:
    wandb:
      project: hescape_training

############ Hydra specific configurations ############
hydra:
  job:
    name: hescape_training
  sweeper:
    params:
      model.litmodule.img_enc_name: h0-mini
      model.litmodule.img_finetune: true  # Lora finetune
      model.litmodule.img_proj: mlp
      model.litmodule.gene_enc_name: generic # drvi is best performing
      model.litmodule.gene_finetune: false
      model.litmodule.gene_proj: linear
      model.litmodule.loss: CLIP
      model.litmodule.temperature: 0.07
      datamodule.seed: 24442
      datamodule.batch_size: 64
      datamodule.num_workers: 4
      training.train: true
      training.test: false
